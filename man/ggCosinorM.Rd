% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ggCosinorM.R
\name{ggCosinorM}
\alias{ggCosinorM}
\title{Plot `CosinorM` and `CosinorM.KDE` Fit with `ggplot2`}
\usage{
ggCosinorM(
  object,
  labels = TRUE,
  ci = TRUE,
  ci_level = 0.95,
  n = 400,
  point_size = 0.5,
  title_extra = NULL,
  legend.position = "right",
  ...
)
}
\arguments{
\item{object}{A fitted model of class \code{\link{CosinorM}} or \code{\link{CosinorM.KDE}}}

\item{labels}{Logical; Default `TRUE` places repelled labels on the plot with MESOR, amplitude(s), and acrophase(s).}

\item{ci}{Logical; Default `TRUE` computes and draws pointwise parametric confidence bands for the fitted cosinor curve using the model covariance.}

\item{ci_level}{Confidence level for the pointwise bands, expressed in numeric value between 0 and 1.}

\item{n}{Integer; number of points on the fine prediction grid used to draw the fitted cosinor and confidence ribbon. (default to `400`)}

\item{point_size}{Numeric; plotting size for observed points. (default: `0.5`)}

\item{title_extra}{Optional character string appended to the plot title for extra context.}

\item{legend.position}{Position of the legend on the plot; default is `"right"`. Other options include `"top"`, `"bottom"`, `"left"`, or a numeric vector of length two specifying x and y coordinates.}

\item{...}{Additional arguments (currently ignored) kept for future update}
}
\description{
Create visualization of a CosinorM or CosinorM.KDE fit using ggplot2. The plot shows the parametric cosinor fit over a fine time grid, optional pointwise confidence bands, observed data points, MESOR line, acrophase verticals, amplitude annotation segments, and labelled parameter values when requested.
}
\examples{
\dontrun{
# Import data
data(FlyEast)

BdfList =
BriefSum(df = FlyEast ,
         SR = 1/60,
         Start = "2017-10-24 13:45:00")

# Let's extract actigraphy data from a single day
df <- BdfList$df
df <- subset(df, df$Date == "2017-10-28")

fit <- CosinorM(time = df$Time,
                activity = df$Activity,
                tau = 24,
                method = "OLS")


p <- ggCosinorM(object = fit,
                labels = TRUE,
                ci = TRUE,
                ci_level = 0.95,
                title_extra = "2017-10-24")
print(p)
}

}
\seealso{
\code{\link[ggplot2]{ggplot}}, \code{\link[ggrepel]{geom_label_repel}}, \code{\link[stats]{predict}}
}
\keyword{cosinor}
\keyword{ggplot}
\keyword{graph}
\keyword{plot}
