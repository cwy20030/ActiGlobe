% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/se.CosinorM.R
\name{se.CosinorM}
\alias{se.CosinorM}
\title{standard error for `Cosinor` coefficients}
\usage{
se.CosinorM(object)
}
\arguments{
\item{object}{model of class `CosinorM`

Standard errors are the square roots of the approximated variances.}
}
\value{
A named list with components:
\itemize{
  \item \code{var.Amplitude}: Approximated variance of amplitude.
  \item \code{var.Acrophase}: Approximated variance of acrophase.
  \item \code{se.Amplitude}: Delta‑method standard error for amplitude.
  \item \code{se.Acrophase}: Delta‑method standard error for acrophase.
}
}
\description{
Delta‑method derivatives and variances for cosinor amplitude and acrophase
}
\details{
Compute partial derivatives, and delta‑method variances for amplitude and
acrophase from linearized cosinor coefficients for cosine (\eqn{\beta}) and
sine (\eqn{\gamma}) waves, using the variance–covariance matrix. Note that
the matrix is k-by-k, where \eqn{k = 2 * numbers of \tau specified}. See \code{\link{CosinorM}}
The cosinor mapping is:

\strong{Amplitude} (point estimate, \eqn{A = \sqrt{\beta^2 + \gamma^2}}):

Partial derivatives (gradient) are:
\eqn{\frac{\partial A}{\partial \beta} = \frac{\beta}{A}}
\eqn{\frac{\partial A}{\partial \gamma} = \frac{\gamma}{A}}

Delta-method variance formulas (quadratic form) are:
\deqn{\operatorname{Var}(A) \approx \left(\frac{\partial A}{\partial \beta}\right)^2 \operatorname{Var}(\beta)
\;+\; 2\left(\frac{\partial A}{\partial \beta}\right)\left(\frac{\partial A}{\partial \gamma}\right)\operatorname{Cov}(\beta,\gamma)
\;+\; \left(\frac{\partial A}{\partial \gamma}\right)^2 \operatorname{Var}(\gamma).}

\strong{Acrophase} (point estimate, \eqn{\phi = \operatorname{atan2}(\gamma,\beta)}):
Equivalently,
\eqn{\tan(\phi)=\frac{\gamma}{\beta}.}

Differentiate both sides treating \eqn{\phi} as a function of \eqn{\beta} and \eqn{\gamma}.

With respect to \eqn{\beta}:
\eqn{\frac{d}{d\beta}\tan(\phi)=\frac{d}{d\beta}\left(\frac{\gamma}{\beta}\right).}
By the chain rule on the left:
\eqn{\sec^2(\phi)\,\frac{\partial\phi}{\partial\beta} = -\frac{\gamma}{\beta^2}.}
Solve for \eqn{\partial\phi/\partial\beta}:
\eqn{\frac{\partial\phi}{\partial\beta} = -\frac{\gamma}{\beta^2 \sec^2(\phi)}.}
Use \eqn{\sec^2(\phi)=1+\tan^2(\phi)=1+\left(\frac{\gamma}{\beta}\right)^2=\frac{\beta^2+\gamma^2}{\beta^2}}
to obtain:
\eqn{\frac{\partial\phi}{\partial\beta} = -\frac{\gamma}{\beta^2+\gamma^2}.}

With respect to \eqn{\gamma}:
\eqn{\frac{d}{d\gamma}\tan(\phi)=\frac{d}{d\gamma}\left(\frac{\gamma}{\beta}\right).}
By the chain rule on the left:
\eqn{\sec^2(\phi)\,\frac{\partial\phi}{\partial\gamma} = \frac{1}{\beta}.}
Solve for \eqn{\partial\phi/\partial\gamma}:
\eqn{\frac{\partial\phi}{\partial\gamma} = \frac{1}{\beta \sec^2(\phi)} = \frac{\beta}{\beta^2+\gamma^2}.}

Partial derivatives (compact form) are:
\eqn{\frac{\partial \phi}{\partial \beta} = -\frac{\gamma}{\beta^2 + \gamma^2}}
\eqn{\frac{\partial \phi}{\partial \gamma} =  \frac{\beta}{\beta^2 + \gamma^2}}

Delta-method variance formulas (quadratic form) are:
\eqn{\operatorname{Var}(\phi) \approx \left(\frac{\partial \phi}{\partial \beta}\right)^2 \operatorname{Var}(\beta)
\;+\; 2\left(\frac{\partial \phi}{\partial \beta}\right)\left(\frac{\partial \phi}{\partial \gamma}\right)\operatorname{Cov}(\beta,\gamma)
\;+\; \left(\frac{\partial \phi}{\partial \gamma}\right)^2 \operatorname{Var}(\gamma).}
}
\examples{
# Example using named vcov submatrix for beta and gamma
beta <- 3
gamma <- 4
vcov_bg <- matrix(c(1.0, 0.2, 0.2, 0.9), nrow = 2,
                  dimnames = list(c("beta","gamma"), c("beta","gamma")))

# Compute estimates and Delta SEs
res <- cosinor_delta(beta = beta, gamma = gamma, vcov = vcov_bg)
print(res)

}
\seealso{
\code{\link{vcov}}, Delta method references
}
