<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>`Cosinor` Model — CosinorM • ActiGlobe</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="`Cosinor` Model — CosinorM"><meta property="og:description" content="Fit a cosine-based harmonic linear regression on circular time (hours of day)"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ActiGlobe</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Circadian-Analysis.html">Circadian-Analysis</a>
    </li>
    <li>
      <a href="../articles/Graphic-Report.html">Graphic-Report</a>
    </li>
    <li>
      <a href="../articles/Time-Shift.html">Time-Shift</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cwy20030/ActiGlobe/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>`Cosinor` Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/cwy20030/ActiGlobe/blob/HEAD/R/CosinorM.R" class="external-link"><code>R/CosinorM.R</code></a></small>
    <div class="hidden name"><code>CosinorM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit a cosine-based harmonic linear regression on circular time (hours of day)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CosinorM</span><span class="op">(</span></span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">activity</span>,</span>
<span>  <span class="va">tau</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"OLS"</span>,</span>
<span>  arctan2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"HC3"</span>,</span>
<span>  dilute <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Numeric vector of time coordinates for each data point</p></dd>


<dt id="arg-activity">activity<a class="anchor" aria-label="anchor" href="#arg-activity"></a></dt>
<dd><p>Numeric vector of activity counts from an actigraphy device</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Numeric scalar or vector for the assumed circadian period. Default is 24 for single-phase; multiple phases can be supplied via [c()]</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying estimation method</p><ul><li><p>"OLS": Ordinary least squares via <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> (default)</p></li>
<li><p>"FGLS": Feasible generalized least squares; models heteroskedasticity via a log-variance fit to squared OLS residuals, computes weights, and refits by weighted least squares</p></li>
</ul></dd>


<dt id="arg-arctan-">arctan2<a class="anchor" aria-label="anchor" href="#arg-arctan-"></a></dt>
<dd><p>Logical; if TRUE (default) acrophase is computed with
<code>atan2(gamma, beta)</code>, resulting in the quadrant interval between
\(-\pi\) and \(\pi\). Whereas, when set to FALSE, the legacy arctangent
quadrant is mapped. The resulting interval lies between \(-\frac{\pi}{2}\)
and \(\frac{\pi}{2}\).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string passed to <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html" class="external-link">vcovHC</a></code> for robust standard error computation</p></dd>


<dt id="arg-dilute">dilute<a class="anchor" aria-label="anchor" href="#arg-dilute"></a></dt>
<dd><p>Logical;</p><ul><li><p>"FALSE": All essential parameters would be produced.  (default)</p></li>
<li><p>"TRUE": Only cosinor coefficients are returned. This is suited for post-hoc processes, such as computing confidence interval via nonparametric bootstrap</p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class c("CosinorM", "lm") containing:</p><ul><li><p>parm: Parameters specified in the model</p></li>
<li><p>tau: The assumed period length</p></li>
<li><p>time: The time coordinates of the recording</p></li>
<li><p>method: The estimation method used</p></li>
<li><p>coef.cosinor: Named numeric vector with entries:</p><ul><li><p>MESOR: Mid-line estimating statistic of rhythm</p></li>
<li><p>Amplitude: Predicted peak activity magnitude</p></li>
<li><p>Acrophase: Acrophase in radian (time-of-peak)</p></li>
<li><p>Beta: the coefficient of the cosine function</p></li>
<li><p>Gamma: the coefficient of the sine function</p></li>
</ul></li>
<li><p>post.hoc: Post-hoc peak/trough diagnostics derived from fitted.values at observation angles (MESOR.ph, Bathyphase.ph.time, Trough.ph, Acrophase.ph.time, Peak.ph, Amplitude.ph)</p></li>
<li><p>extra: only available for ultradian (i.e., \(\tau\) less than 24hour) single-component model</p></li>
<li><p>vcov: Robust variance-covariance matrix</p></li>
<li><p>se: Standard errors</p></li>
</ul><p>Inherits all components from <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The `Cosinor` model is a cosine-based harmonic regression used to estimate circadian rhythm parameters.</p>
<p><strong>Single-phase equation</strong>:
      $$y = M + A \cos \left(\frac{2\pi t}{\tau} - \phi\right) $$</p><ul><li><p>\(M \): MESOR (mid-line estimating statistic of rhythm), the intercept</p></li>
<li><p>\(A \): Amplitude, peak deviation from M</p></li>
<li><p>\(t \): Time coordinate within the cycle</p></li>
<li><p>\(\tau \): The assumed period length</p></li>
<li><p>\(\phi \): Acrophase (time-of-peak), computed from fitted sine and cosine coefficients</p></li>
</ul><p>Note that because the model is parameterized with a negative phase inside the
cosine, this means the the derived peak time from acrophase corresponds to
the peak time forward from midnight (not backward). In other words, the
when the acrophase is positive, it means the peak activity time occurs after
midnight and vice versa.</p>

<p><strong>Linearized form</strong>:
     $$\hat{y} = M + \beta x + \gamma z + \epsilon $$</p><ul><li><p>\(\beta = A * cos(\phi)\), estimated coefficient for the cosine term</p></li>
<li><p>\(x = cos(\frac{2 * \pi * t} {\tau})\), cosine-transformed time</p></li>
<li><p>\(\gamma = A * sin(\phi)\), estimated coefficient for the sine term</p></li>
<li><p>\(z = sin(\frac{2 * \pi * t} {\tau})\), sine-transformed time</p></li>
<li><p>\(\epsilon \): error term</p></li>
</ul><p>Model parameters are estimated by minimizing the residual sum of squares:
$$RSS = \sum_{i=1}^n (y_i - (M + \beta x_i + \gamma z_i))^2$$
By default, <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> fits this via QR decomposition.</p>
<p><strong>Acrophase \(\phi\) interpretation</strong>:
 \(\phi \) is derived from
 $$\phi = \arctan2(\frac{\gamma} {\beta}) $$</p>
<p>Note,</p><ul><li><p>\(\phi \) can be converted to clock time to identify the peak activity time AFTER midnight.</p></li>
<li><p>if the model is not a mono-phase (i.e., more than one \(\tau \)), there will be \(\frac{24 (hours)} {\tau} \) number of peaks within a day.</p></li>
</ul><p><strong>Amplitude \((A) \) estimation</strong>:
Amplitude is calculated from fitted sine and cosine coefficients as:
$$A= \sqrt {(\beta^2 + \gamma^2)}$$</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chambers, J. M. (1992) Linear models. Chapter 4 of Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.</p>
<p>Wilkinson, G. N. and Rogers, C. E. (1973). Symbolic descriptions of factorial models for analysis of variance. Applied Statistics, 22, 392-399. doi:10.2307/2346786.</p>
<p>Harvey, A. C. (1976). Estimating Regression Models with Multiplicative Heteroscedasticity. Econometrica, 44(3), 461-465. doi:10.2307/1913974</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>  <code><a href="CosinorM.KDE.html">CosinorM.KDE</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span> <span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span> <span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Import data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span> <span class="op">(</span><span class="va">FlyEast</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create quick summary of the recording with adjustment for daylight saving.</span></span></span>
<span class="r-in"><span><span class="va">BdfList</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="BriefSum.html">BriefSum</a></span> <span class="op">(</span></span></span>
<span class="r-in"><span>        df <span class="op">=</span> <span class="va">FlyEast</span>,</span></span>
<span class="r-in"><span>        SR <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>        Start <span class="op">=</span> <span class="st">"2017-10-24 13:45:00"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let's extract actigraphy data from a single day</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">BdfList</span><span class="op">$</span><span class="va">df</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span> <span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">$</span><span class="va">Date</span> <span class="op">==</span> <span class="st">"2017-10-27"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">CosinorM</span> <span class="op">(</span></span></span>
<span class="r-in"><span>    time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span></span>
<span class="r-in"><span>    activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span></span>
<span class="r-in"><span>    tau <span class="op">=</span> <span class="fl">24</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"OLS"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inspect coefficients</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">coef.cosinor</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot Cosinor in hours</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span> <span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">time</span>, <span class="va">fit</span><span class="op">$</span><span class="va">fitted.values</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Hour"</span>, ylab <span class="op">=</span> <span class="st">"24-Hour Cosinor Model"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by C. William Yao, Giorgio Varesco, François Bieuzen, Guido Simonelli.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

