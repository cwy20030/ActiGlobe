<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>`Cosinor` Model — CosinorM • ActiGlobe</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`Cosinor` Model — CosinorM"><meta name="description" content="Fit a cosine-based harmonic linear regression on circular time (hours of day)"><meta property="og:description" content="Fit a cosine-based harmonic linear regression on circular time (hours of day)"><meta property="og:image" content="https://cwy20030.github.io/ActiGlobe/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ActiGlobe</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Circadian-Analysis.html">Circadian-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Graphic-Report.html">Graphic-Report</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Time-Shift.html">Time-Shift</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cwy20030/ActiGlobe/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>`Cosinor` Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/cwy20030/ActiGlobe/blob/Test-Copilot/R/CosinorM.R" class="external-link"><code>R/CosinorM.R</code></a></small>
      <div class="d-none name"><code>CosinorM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a cosine-based harmonic linear regression on circular time (hours of day)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CosinorM</span><span class="op">(</span></span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">activity</span>,</span>
<span>  <span class="va">tau</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"OLS"</span>,</span>
<span>  arctan2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"HC3"</span>,</span>
<span>  dilute <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Numeric vector of time coordinates for each data point</p></dd>


<dt id="arg-activity">activity<a class="anchor" aria-label="anchor" href="#arg-activity"></a></dt>
<dd><p>Numeric vector of activity counts from an actigraphy device</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Numeric scalar or vector for the assumed circadian
period. Default is 24 for single-phase; multiple phases can be
supplied via [c()]</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying estimation method</p><ul><li><p>"OLS": Ordinary least squares via <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> (default)</p></li>
<li><p>"FGLS": Feasible generalized least squares; models
    heteroskedasticity via a log-variance fit to squared OLS
    residuals, computes weights, and refits by weighted least
    squares</p></li>
</ul></dd>


<dt id="arg-arctan-">arctan2<a class="anchor" aria-label="anchor" href="#arg-arctan-"></a></dt>
<dd><p>Logical; if TRUE (default) acrophase is computed with
<code>atan2(gamma, beta)</code>, resulting in the quadrant interval between
\(-\pi\) and \(\pi\). Whereas, when set to FALSE, the legacy arctangent
quadrant is mapped. The resulting interval lies between
\(-\frac{\pi}{2}\) and \(\frac{\pi}{2}\).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string passed to
<code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html" class="external-link">vcovHC</a></code> for robust standard error
computation</p></dd>


<dt id="arg-dilute">dilute<a class="anchor" aria-label="anchor" href="#arg-dilute"></a></dt>
<dd><p>Logical;</p><ul><li><p>"FALSE": All essential parameters would be produced.  (default)</p></li>
<li><p>"TRUE": Only cosinor coefficients are returned. This is
    suited for post-hoc processes, such as computing confidence
    interval via nonparametric bootstrap</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class c("CosinorM", "lm") containing:</p><ul><li><p>parm: Parameters specified in the model</p></li>
<li><p>tau: The assumed period length</p></li>
<li><p>time: The time coordinates of the recording</p></li>
<li><p>method: The estimation method used</p></li>
<li><p>coef.cosinor: Named numeric vector with entries:</p><ul><li><p>MESOR: Mid-line estimating statistic of rhythm</p></li>
<li><p>Amplitude: Predicted peak activity magnitude</p></li>
<li><p>Acrophase: Acrophase in radian (time-of-peak)</p></li>
<li><p>Beta: the coefficient of the cosine function</p></li>
<li><p>Gamma: the coefficient of the sine function</p></li>
</ul></li>
<li><p>post.hoc: Post-hoc peak/trough diagnostics derived from
    fitted.values at observation angles (MESOR.ph,
    Bathyphase.ph.time, Trough.ph, Acrophase.ph.time, Peak.ph,
    Amplitude.ph)</p></li>
<li><p>extra: only available for ultradian (i.e., \(\tau\) less
    than 24hour) single-component model</p></li>
<li><p>vcov: Robust variance-covariance matrix</p></li>
<li><p>se: Standard errors</p></li>
</ul><p>Inherits all components from <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The `Cosinor` model is a cosine-based harmonic regression used
to estimate circadian rhythm parameters.</p>
<p><strong>Single-phase equation</strong>:
      $$y = M + A \cos \left(\frac{2\pi t}{\tau} - \phi\right) $$</p><ul><li><p>\(M \): MESOR (mid-line estimating statistic of
    rhythm), the intercept</p></li>
<li><p>\(A \): Amplitude, peak deviation from M</p></li>
<li><p>\(t \): Time coordinate within the cycle</p></li>
<li><p>\(\tau \): The assumed period length</p></li>
<li><p>\(\phi \): Acrophase (time-of-peak), computed from
    fitted sine and cosine coefficients</p></li>
</ul><p>Note that because the model is parameterized with a negative phase inside the
cosine, this means the the derived peak time from acrophase corresponds to
the peak time forward from midnight (not backward). In other words, the
when the acrophase is positive, it means the peak activity time occurs after
midnight and vice versa.</p>

<p><strong>Linearized form</strong>:
     $$\hat{y} = M + \beta x + \gamma z + \epsilon $$</p><ul><li><p>\(\beta = A * cos(\phi)\), estimated coefficient for
    the cosine term</p></li>
<li><p>\(x = cos(\frac{2 * \pi * t} {\tau})\), cosine-transformed time</p></li>
<li><p>\(\gamma = A * sin(\phi)\), estimated coefficient for the sine term</p></li>
<li><p>\(z = sin(\frac{2 * \pi * t} {\tau})\), sine-transformed time</p></li>
<li><p>\(\epsilon \): error term</p></li>
</ul><p>Model parameters are estimated by minimizing the residual sum of squares:
$$RSS = \sum_{i=1}^n (y_i - (M + \beta x_i + \gamma z_i))^2$$
By default, <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> fits this via QR decomposition.</p>
<p><strong>Acrophase \(\phi\) interpretation</strong>:
 \(\phi \) is derived from
 $$\phi = \arctan2(\frac{\gamma} {\beta}) $$</p>
<p>Note,</p><ul><li><p>\(\phi \) can be converted to clock time to identify
    the peak activity time AFTER midnight.</p></li>
<li><p>if the model is not a mono-phase (i.e., more than one
    \(\tau \)), there will be \(\frac{24 (hours)} {\tau} \)
    number of peaks within a day.</p></li>
</ul><p><strong>Amplitude \((A) \) estimation</strong>:
Amplitude is calculated from fitted sine and cosine coefficients as:
$$A= \sqrt {(\beta^2 + \gamma^2)}$$</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cornelissen G. Cosinor-based rhythmometry. Theoretical Biology
and Medical Modelling. 2014-12-01 2014;11(1):16.
doi:10.1186/1742-4682-11-16</p>
<p>Chambers, J. M. (1992) Linear models. Chapter 4 of Statistical
Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth &amp;
Brooks/Cole.</p>
<p>Wilkinson, G. N. and Rogers, C. E. (1973). Symbolic descriptions
of factorial models for analysis of variance. Applied Statistics,
22, 392-399. doi:10.2307/2346786.</p>
<p>Harvey, A. C. (1976). Estimating Regression Models with
Multiplicative Heteroscedasticity. Econometrica, 44(3), 461-465.
doi:10.2307/1913974</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>  <code><a href="CosinorM.KDE.html">CosinorM.KDE</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span> <span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span> <span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Import data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span> <span class="op">(</span><span class="va">FlyEast</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create quick summary of the recording with adjustment for daylight saving.</span></span></span>
<span class="r-in"><span><span class="va">BdfList</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="BriefSum.html">BriefSum</a></span> <span class="op">(</span></span></span>
<span class="r-in"><span>        df <span class="op">=</span> <span class="va">FlyEast</span>,</span></span>
<span class="r-in"><span>        SR <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>        Start <span class="op">=</span> <span class="st">"2017-10-24 13:45:00"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let's extract actigraphy data from a single day</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">BdfList</span><span class="op">$</span><span class="va">df</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span> <span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">$</span><span class="va">Date</span> <span class="op">==</span> <span class="st">"2017-10-27"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">CosinorM</span> <span class="op">(</span></span></span>
<span class="r-in"><span>    time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span></span>
<span class="r-in"><span>    activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span></span>
<span class="r-in"><span>    tau <span class="op">=</span> <span class="fl">24</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"OLS"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inspect coefficients</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">coef.cosinor</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot Cosinor in hours</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span> <span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">time</span>, <span class="va">fit</span><span class="op">$</span><span class="va">fitted.values</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Hour"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"24-Hour Cosinor Model"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by C. William Yao, Giorgio Varesco, François Bieuzen, Guido Simonelli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

