<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Circadian-Analysis • ActiGlobe</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Circadian-Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ActiGlobe</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Circadian-Analysis.html">Circadian-Analysis</a>
    </li>
    <li>
      <a href="../articles/Graphic-Report.html">Graphic-Report</a>
    </li>
    <li>
      <a href="../articles/Time-Shift.html">Time-Shift</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cwy20030/ActiGlobe/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Circadian-Analysis</h1>
            <h3 data-toc-skip class="subtitle">Cosinor Analysis and
Circularized Kernel Density Estimation</h3>
                        <h4 data-toc-skip class="author">C. William
Yao</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cwy20030/ActiGlobe/blob/HEAD/vignettes/Circadian-Analysis.Rmd" class="external-link"><code>vignettes/Circadian-Analysis.Rmd</code></a></small>
      <div class="hidden name"><code>Circadian-Analysis.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="cosinor-analysis">Cosinor Analysis<a class="anchor" aria-label="anchor" href="#cosinor-analysis"></a>
</h2>
<p>After we segmented the data by dates, we can now move on to model the
circadian rhythm based on the activity scores. For this, we are going to
use the pre-travel recording on the 27<sup>th</sup> of October. Since
the recording was not affected by time change. We can simply export it
to a new variable, called , which is short for data frame.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span> <span class="op">(</span><span class="st">"FlyEast"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BdfList</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/BriefSum.html">BriefSum</a></span> <span class="op">(</span></span>
<span>        df <span class="op">=</span> <span class="va">FlyEast</span>,</span>
<span>        SR <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">60</span>,</span>
<span>        Start <span class="op">=</span> <span class="st">"2017-10-24 13:45:00"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Let's extract actigraphy data from a single day</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">BdfList</span><span class="op">$</span><span class="va">df</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span> <span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">$</span><span class="va">Date</span> <span class="op">==</span> <span class="st">"2017-10-27"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="single-phase-model-i-e--single-phase-circadian-rhythm">Single-phase Model (i.e., single phase circadian rhythm)<a class="anchor" aria-label="anchor" href="#single-phase-model-i-e--single-phase-circadian-rhythm"></a>
</h3>
<div class="section level4">
<h4 id="traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols">Traditional Cosinor Model fitted via Ordinary Least Sqaure
(OLS)<a class="anchor" aria-label="anchor" href="#traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.ols</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span> <span class="op">(</span></span>
<span>        time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>        activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>        tau <span class="op">=</span> <span class="fl">24</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"OLS"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co">### Look at the parameters</span></span>
<span><span class="va">fit.ols</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.24 Acrophase.24      Beta.24     Gamma.24 </span></span>
<span><span class="co">#&gt;   177.297222   161.296243    -2.896002  -156.456357   -39.215893</span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span> <span class="op">(</span><span class="va">fit.ols</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%201%20OLS-1.png" class="r-plt" alt="Figure 1: Fitting of OLS-based Cosinor Model" width="672"></p>
</div>
<div class="section level4">
<h4 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h4>
<p>If we process using the , we will notice that the results look a bit
different. This is because ActiGlobe treats the first time point of the
day as , whereas it is often treated as the first time point due to the
specification in the sequence generator.</p>
</div>
<div class="section level4">
<h4 id="ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls">Ecnometry-modified Cosinor Model with Feasible General Least Sqaure
(FGLS)<a class="anchor" aria-label="anchor" href="#ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls"></a>
</h4>
<p>Besides, the traditioanl OLS-based cosinor model, also allows user to
estimate model using FGLS-based method. In ActiGlobe, the FGLS was
implemented via a weighted residual least square approximation. This
two-step process often produces a better representation of the “boarder”
between sleep and awake activity than otherwise from the traditional
OLS. Nevertheless, neither methods can offer realistic few of our
activity pattern given they are simply single-phase cosinor models.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fgls</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span> <span class="op">(</span></span>
<span>        time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>        activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>        tau <span class="op">=</span> <span class="fl">24</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"FGLS"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co">### Look at the parameters</span></span>
<span><span class="va">fit.fgls</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.24 Acrophase.24      Beta.24     Gamma.24 </span></span>
<span><span class="co">#&gt;   181.169023   183.040124    -2.409542  -136.146165  -122.343405</span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span> <span class="op">(</span><span class="va">fit.fgls</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%201%20FGLS-1.png" class="r-plt" alt="Figure 2: Fitting of FGLS-based Cosinor Model" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="dual-phase-model-i-e--12-24hour-rhythms">Dual-phase Model (i.e., 12 + 24hour rhythms)<a class="anchor" aria-label="anchor" href="#dual-phase-model-i-e--12-24hour-rhythms"></a>
</h3>
<p>While certain circadian measures, such as melatonin, often follow a
roughly 24-hour single-phase, human activity pattern is generally
fragmented. To capture the non-linearity in our activity pattern, it is
possible to add additional phase components when using . Here, we
provided two examples of cosinor models with two phase components, each
fitted using OLS or FGLS-based methods.</p>
<div class="section level4">
<h4 id="traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols-1">Traditional Cosinor Model fitted via Ordinary Least Sqaure
(OLS)<a class="anchor" aria-label="anchor" href="#traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols-1"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.ols2</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span> <span class="op">(</span></span>
<span>        time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>        activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>        tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span> <span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"OLS"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fit.ols2</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.12 Amplitude.24 Acrophase.12 Acrophase.24      Beta.12 </span></span>
<span><span class="co">#&gt;  177.2972222  136.4395529  161.2962432   -0.9644981   -2.8960017   77.7472728 </span></span>
<span><span class="co">#&gt;      Beta.24     Gamma.12     Gamma.24 </span></span>
<span><span class="co">#&gt; -156.4563575 -112.1209756  -39.2158930</span></span>
<span><span class="va">fit.ols2</span><span class="op">$</span><span class="va">post.hoc</span></span>
<span><span class="co">#&gt;           MESOR.ph Bathyphase.ph.time          Trough.ph  Acrophase.ph.time </span></span>
<span><span class="co">#&gt;         182.629625           3.466667         -77.533671          10.783333 </span></span>
<span><span class="co">#&gt;            Peak.ph       Amplitude.ph </span></span>
<span><span class="co">#&gt;         442.792922         260.163297</span></span>
<span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span> <span class="op">(</span><span class="va">fit.ols2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%202%20OLS-1.png" class="r-plt" alt="Figure 3: Fitting of the Dual-phase OLS-based Multi-comopnent Cosinor Model" width="672"></p>
</div>
<div class="section level4">
<h4 id="ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls-1">Ecnometry-modified Cosinor Model with Feasible General Least Sqaure
(FGLS)<a class="anchor" aria-label="anchor" href="#ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls-1"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fgls2</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span> <span class="op">(</span></span>
<span>        time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>        activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>        tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span> <span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"FGLS"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fit.fgls2</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.12 Amplitude.24 Acrophase.12 Acrophase.24      Beta.12 </span></span>
<span><span class="co">#&gt;  148.6450319   52.7954160  128.4419382   -0.7394464   -2.7311777   39.0074572 </span></span>
<span><span class="co">#&gt;      Beta.24     Gamma.12     Gamma.24 </span></span>
<span><span class="co">#&gt; -117.7755191  -35.5777211  -51.2470351</span></span>
<span><span class="va">fit.fgls2</span><span class="op">$</span><span class="va">post.hoc</span></span>
<span><span class="co">#&gt;           MESOR.ph Bathyphase.ph.time          Trough.ph  Acrophase.ph.time </span></span>
<span><span class="co">#&gt;         148.959604           3.450000          -8.218935          11.750000 </span></span>
<span><span class="co">#&gt;            Peak.ph       Amplitude.ph </span></span>
<span><span class="co">#&gt;         306.138144         157.178540</span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span> <span class="op">(</span><span class="va">fit.fgls2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%202%20FGLS-1.png" class="r-plt" alt="Figure 4: Fitting of the Dual-phase FGLS-based Multi-comopnent Cosinor Model" width="672"></p>
<p>It is worth noting that we cannot individually interpret each cosinor
parameters alone when fitting a multicomponent model, This is because
the rest-activity patterns estimated by general linear regression is the
cumulative sum of all the fitted cosinor components (i.e. both 12 and
24hour waves). As such, it is better to use the parameters extracted
post hoc for analysis.</p>
<pre><code><span><span class="co">#&gt;    Beta.12   Gamma.12     phi.12 </span></span>
<span><span class="co">#&gt;   77.74727 -112.12098   10.15794 </span></span>
<span><span class="co">#&gt;    Beta.24   Gamma.24     phi.24 </span></span>
<span><span class="co">#&gt; -156.45636  -39.21589   12.93809</span></span></code></pre>
<p><img src="Circadian-Analysis_files/figure-html/Model%202%20OLS%20in%20parts-1.png" class="r-plt" alt="Figure 5 Opening the Dual-phase OLS-based Cosinor Model into 12 and 24hour components" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="circularized-gaussian-kernel-density-estimation-kde">Circularized Gaussian Kernel Density Estimation (KDE)<a class="anchor" aria-label="anchor" href="#circularized-gaussian-kernel-density-estimation-kde"></a>
</h3>
<p>Besides the traditional cosinor-based methodology, ActiGlobe also
offers circularized Gaussian kernel density estimation. In contrast to
the traditional cosinor method, uses nonparametric kernel smoothing to
map the activity pattern on a circularized time-domain. This strategy
allows it to better respect the intensity and the duration of the
underlying rest-activity patterns, without forcing a sinusoidal shape.
To facilitate transition from cosinor model, we designed to generate
cosinor-like parameters by projecting the model onto an imaginary
cosinor plane.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.KDE</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/CosinorM.KDE.html">CosinorM.KDE</a></span> <span class="op">(</span></span>
<span>        time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>        activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co">### Look at the parameters</span></span>
<span><span class="va">fit.KDE</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.24 Acrophase.24      Beta.24     Gamma.24 </span></span>
<span><span class="co">#&gt;   177.270466   157.852411    -2.896046  -153.117574   -38.371762</span></span>
<span><span class="va">fit.KDE</span><span class="op">$</span><span class="va">post.hoc</span></span>
<span><span class="co">#&gt;           MESOR.ph Bathyphase.ph.time          Trough.ph  Acrophase.ph.time </span></span>
<span><span class="co">#&gt;         296.160217           5.433333           9.099325          10.483333 </span></span>
<span><span class="co">#&gt;            Peak.ph       Amplitude.ph </span></span>
<span><span class="co">#&gt;         583.221110         287.060893</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span> <span class="op">(</span><span class="va">fit.KDE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%201%20KDE-1.png" class="r-plt" alt="Figure 6: Fitting of Circularized Gaussian Kernel Density Estimation" width="672"></p>
<p>It is worth noting that while does provide a variance and standard
error of the fitted rest-activity pattern, this is a density‑based
signal‑processing strategy not a regression model. As a
signal‑processing technique, lacks the ability to directly provide
standard errors or confidence intervals for cosinor parameters and
related post hoc estimates (e.g., bathyphase). Thankfully, we can take
the advantage of bootstrap resampling to empirically estimate confidence
intervals and standard errors for these post‑hoc parameters. Note that
is designed to stabilize estimates when data are irregularly spaced or
limited to short recording intervals.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot.seci.html">boot.seci</a></span> <span class="op">(</span></span>
<span>    object <span class="op">=</span> <span class="va">fit.KDE</span>,</span>
<span>    level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>    N <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span> <span class="co">### for demonstration, the number of bootstrap was limited to 100.</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value    2.5%   97.5%</span></span>
<span><span class="co">#&gt; MESOR                177.24       4.60   38.55  168.93  185.37</span></span>
<span><span class="co">#&gt; Amplitude.24         157.66       7.15   22.08  145.51  171.65</span></span>
<span><span class="co">#&gt; Acrophase.24          -2.89       0.04  -73.22   -2.96   -2.82</span></span>
<span><span class="co">#&gt; Beta.24             -152.48       7.90  -19.39 -167.73 -138.96</span></span>
<span><span class="co">#&gt; Gamma.24             -39.60       5.28   -7.27  -48.30  -29.41</span></span>
<span><span class="co">#&gt; MESOR.ph             295.55      14.50   20.43  266.18  324.46</span></span>
<span><span class="co">#&gt; Bathyphase.ph.time     4.35       1.83    2.96    0.60    6.13</span></span>
<span><span class="co">#&gt; Trough.ph              8.12       1.84    4.93    5.09   11.66</span></span>
<span><span class="co">#&gt; Acrophase.ph.time     10.50       0.31   33.60    9.97   11.05</span></span>
<span><span class="co">#&gt; Peak.ph              582.97      29.10   20.04  522.64  638.85</span></span>
<span><span class="co">#&gt; Amplitude.ph         287.43      14.66   19.58  257.36  314.75</span></span></code></pre></div>
<p>Currently, was designed to compute standard errors and confidence
intervals in serial processes, which means that it will take some time
to finish the computation.</p>
<div class="section level4">
<h4 id="visualized-model-comparisons">Visualized Model Comparisons<a class="anchor" aria-label="anchor" href="#visualized-model-comparisons"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### For external graphic plot.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span> <span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.5.2</span></span></code></pre></div>
<div class="section level5">
<h5 id="ols-cosinor-vs--kernel-density-estimation">OLS-Cosinor vs. Kernel Density Estimation<a class="anchor" aria-label="anchor" href="#ols-cosinor-vs--kernel-density-estimation"></a>
</h5>
<p>When we plot the KDE alongside the cosinor we can immediately see
skew, broad or narrow peaks, and multiple active periods that the
single‑harmonic cosinor cannot represent.
<img src="Circadian-Analysis_files/figure-html/Model%201%20OLS%20vs%20KDE-1.png" class="r-plt" alt="Figure 7: Overlay of Fitting of OLS-based Cosinor and Circularized Gaussian Kernel Density Estimation" width="672"></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by C. William Yao, Giorgio Varesco, François Bieuzen, Guido Simonelli.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
