<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Circadian-Analysis • ActiGlobe</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Circadian-Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ActiGlobe</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Circadian-Analysis.html">Circadian-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Graphic-Report.html">Graphic-Report</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Time-Shift.html">Time-Shift</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cwy20030/ActiGlobe/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Circadian-Analysis</h1>
            <h3 data-toc-skip class="subtitle">Cosinor Analysis and
Circularized Kernel Density Estimation</h3>
                        <h4 data-toc-skip class="author">C. William
Yao</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cwy20030/ActiGlobe/blob/Test-Copilot/vignettes/Circadian-Analysis.Rmd" class="external-link"><code>vignettes/Circadian-Analysis.Rmd</code></a></small>
      <div class="d-none name"><code>Circadian-Analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="cosinor-analysis">Cosinor Analysis<a class="anchor" aria-label="anchor" href="#cosinor-analysis"></a>
</h2>
<p>After we segmented the data by date, we can now model the circadian
rhythm using the activity scores. For this, we will use the pre-travel
recording on the 27<sup>th</sup> of October. Since the recording was not
affected by the time change. We can simply store the unaffected segments
in a new variable called <code>df</code>, which stands for data
frame.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"FlyEast"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BdfList</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/BriefSum.html">BriefSum</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">FlyEast</span>,</span>
<span>    SR <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">60</span>,</span>
<span>    Start <span class="op">=</span> <span class="st">"2017-10-24 13:45:00"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Let's extract actigraphy data from a single day</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">BdfList</span><span class="op">$</span><span class="va">df</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">$</span><span class="va">Date</span> <span class="op">==</span> <span class="st">"2017-10-27"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="single-phase-model-i-e--single-phase-circadian-rhythm">Single-phase Model (i.e., single phase circadian rhythm)<a class="anchor" aria-label="anchor" href="#single-phase-model-i-e--single-phase-circadian-rhythm"></a>
</h3>
<div class="section level4">
<h4 id="traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols">Traditional Cosinor Model fitted via Ordinary Least Sqaure
(OLS)<a class="anchor" aria-label="anchor" href="#traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.ols</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>    tau <span class="op">=</span> <span class="fl">24</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"OLS"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">### Look at the parameters</span></span>
<span><span class="va">fit.ols</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.24 Acrophase.24      Beta.24     Gamma.24 </span></span>
<span><span class="co">#&gt;   177.297222   161.296243    -2.896002  -156.456357   -39.215893</span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span><span class="op">(</span><span class="va">fit.ols</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%201%20OLS-1.png" class="r-plt" alt="Figure 1: Fitting of OLS-based Cosinor Model" width="672"></p>
</div>
<div class="section level4">
<h4 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h4>
<p>If we process <code>FlyEast</code> using the
<code>cosinor::cosinor.lm</code>, we will notice that the results look a
bit different. This is because ActiGlobe treats the first time point of
the day as <code>00:00:00</code>, whereas this is sometimes treated as
<code>00:00:00</code> plus one unit of the device sampling rate due to
the use of the sequence generator.</p>
</div>
<div class="section level4">
<h4 id="ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls">Ecnometry-modified Cosinor Model with Feasible General Least Sqaure
(FGLS)<a class="anchor" aria-label="anchor" href="#ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls"></a>
</h4>
<p>Besides, the traditional OLS-based cosinor
model,<code>CosinorM</code> also allows users to estimate the model
using the FGLS-based method. In ActiGlobe, the FGLS was implemented via
a weighted residual least square approximation. This two-step process
often produces a better representation of the “border” between sleep and
wakefulness than traditional OLS. Nevertheless, neither method can
realistically capture our activity patterns, given that they are simply
single-phase cosinor models.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fgls</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>    tau <span class="op">=</span> <span class="fl">24</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"FGLS"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">### Look at the parameters</span></span>
<span><span class="va">fit.fgls</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.24 Acrophase.24      Beta.24     Gamma.24 </span></span>
<span><span class="co">#&gt;   181.169023   183.040124    -2.409542  -136.146165  -122.343405</span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span><span class="op">(</span><span class="va">fit.fgls</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%201%20FGLS-1.png" class="r-plt" alt="Figure 2: Fitting of FGLS-based Cosinor Model" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="dual-phase-model-i-e--12-24hour-rhythms">Dual-phase Model (i.e., 12 + 24hour rhythms)<a class="anchor" aria-label="anchor" href="#dual-phase-model-i-e--12-24hour-rhythms"></a>
</h3>
<p>While certain circadian measures, such as melatonin, often follow a
roughly 24-hour single-phase, human activity pattern is generally
fragmented. To capture the non-linearity in our activity pattern, it is
possible to add more phase components when using <code>CosinorM</code>.
Here, we provided two examples of cosinor models with two phase
components, each fitted using OLS or FGLS-based methods.</p>
<div class="section level4">
<h4 id="traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols-1">Traditional Cosinor Model fitted via Ordinary Least Sqaure
(OLS)<a class="anchor" aria-label="anchor" href="#traditional-cosinor-model-fitted-via-ordinary-least-sqaure-ols-1"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.ols2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>    tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"OLS"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fit.ols2</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.12 Amplitude.24 Acrophase.12 Acrophase.24      Beta.12 </span></span>
<span><span class="co">#&gt;  177.2972222  136.4395529  161.2962432   -0.9644981   -2.8960017   77.7472728 </span></span>
<span><span class="co">#&gt;      Beta.24     Gamma.12     Gamma.24 </span></span>
<span><span class="co">#&gt; -156.4563575 -112.1209756  -39.2158930</span></span>
<span><span class="va">fit.ols2</span><span class="op">$</span><span class="va">post.hoc</span></span>
<span><span class="co">#&gt;           MESOR.ph Bathyphase.ph.time          Trough.ph  Acrophase.ph.time </span></span>
<span><span class="co">#&gt;         182.629625           3.466667         -77.533671          10.783333 </span></span>
<span><span class="co">#&gt;            Peak.ph       Amplitude.ph </span></span>
<span><span class="co">#&gt;         442.792922         260.163297</span></span>
<span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span><span class="op">(</span><span class="va">fit.ols2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%202%20OLS-1.png" class="r-plt" alt="Figure 3: Fitting of the Dual-phase OLS-based Multi-comopnent Cosinor Model" width="672"></p>
</div>
<div class="section level4">
<h4 id="ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls-1">Ecnometry-modified Cosinor Model with Feasible General Least Sqaure
(FGLS)<a class="anchor" aria-label="anchor" href="#ecnometry-modified-cosinor-model-with-feasible-general-least-sqaure-fgls-1"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fgls2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/CosinorM.html">CosinorM</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span>,</span>
<span>    tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"FGLS"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fit.fgls2</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.12 Amplitude.24 Acrophase.12 Acrophase.24      Beta.12 </span></span>
<span><span class="co">#&gt;  148.6450319   52.7954160  128.4419382   -0.7394464   -2.7311777   39.0074572 </span></span>
<span><span class="co">#&gt;      Beta.24     Gamma.12     Gamma.24 </span></span>
<span><span class="co">#&gt; -117.7755191  -35.5777211  -51.2470351</span></span>
<span><span class="va">fit.fgls2</span><span class="op">$</span><span class="va">post.hoc</span></span>
<span><span class="co">#&gt;           MESOR.ph Bathyphase.ph.time          Trough.ph  Acrophase.ph.time </span></span>
<span><span class="co">#&gt;         148.959604           3.450000          -8.218935          11.750000 </span></span>
<span><span class="co">#&gt;            Peak.ph       Amplitude.ph </span></span>
<span><span class="co">#&gt;         306.138144         157.178540</span></span>
<span></span>
<span><span class="co">### Plot</span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span><span class="op">(</span><span class="va">fit.fgls2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%202%20FGLS-1.png" class="r-plt" alt="Figure 4: Fitting of the Dual-phase FGLS-based Multi-comopnent Cosinor Model" width="672"></p>
<p>It is worth noting that we cannot individually interpret each cosinor
parameter alone when fitting a multicomponent model. This is because the
rest-activity patterns estimated by general linear regression are the
cumulative sums of all the fitted cosinor components (i.e., both 12- and
24-hour waves). As such, it is better to use the post hoc-extracted
parameters for analysis.</p>
<pre><code><span><span class="co">#&gt;    Beta.12   Gamma.12     phi.12 </span></span>
<span><span class="co">#&gt;   77.74727 -112.12098   10.15794 </span></span>
<span><span class="co">#&gt;    Beta.24   Gamma.24     phi.24 </span></span>
<span><span class="co">#&gt; -156.45636  -39.21589   12.93809</span></span></code></pre>
<p><img src="Circadian-Analysis_files/figure-html/Model%202%20OLS%20in%20parts-1.png" class="r-plt" alt="Figure 5 Opening the Dual-phase OLS-based Cosinor Model into 12 and 24hour components" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="gaussian-kernel-density-estimation-on-circularized-time">Gaussian Kernel Density Estimation on Circularized Time<a class="anchor" aria-label="anchor" href="#gaussian-kernel-density-estimation-on-circularized-time"></a>
</h3>
<p>Besides the traditional cosinor rhythmetry, ActiGlobe also offers
Gaussian kernel density estimation (KDE). In contrast to the traditional
cosinor method, <code>CosinrM.KDE</code> uses nonparametric kernel
smoothing to map the activity pattern on a circularized time domain.
This strategy allows it to better respect the intensity and the duration
of the underlying rest-activity patterns, without forcing a sinusoidal
shape. To ease transition from cosinor model, we designed
<code>CosinorM.KDE</code> to generate cosinor-like parameters by
projecting the model onto an imaginary cosinor plane.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.KDE</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/CosinorM.KDE.html">CosinorM.KDE</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    activity <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Activity</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">### Look at the parameters</span></span>
<span><span class="va">fit.KDE</span><span class="op">$</span><span class="va">coef.cosinor</span></span>
<span><span class="co">#&gt;        MESOR Amplitude.24 Acrophase.24      Beta.24     Gamma.24 </span></span>
<span><span class="co">#&gt;   177.270466   157.852411    -2.896046  -153.117574   -38.371762</span></span>
<span><span class="va">fit.KDE</span><span class="op">$</span><span class="va">post.hoc</span></span>
<span><span class="co">#&gt;           MESOR.ph Bathyphase.ph.time          Trough.ph  Acrophase.ph.time </span></span>
<span><span class="co">#&gt;         296.160217           5.433333           9.099325          10.483333 </span></span>
<span><span class="co">#&gt;            Peak.ph       Amplitude.ph </span></span>
<span><span class="co">#&gt;         583.221110         287.060893</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggCosinorM.html">ggCosinorM</a></span><span class="op">(</span><span class="va">fit.KDE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Circadian-Analysis_files/figure-html/Model%201%20KDE-1.png" class="r-plt" alt="Figure 6: Fitting of Circularized Gaussian Kernel Density Estimation" width="672"></p>
<p>It is worth noting that while <code>CosinorM.KDE</code> does provide
a variance and standard error for the fitted rest-activity pattern; this
is a density‑based signal‑processing strategy, not a regression model.
As a signal‑processing technique, <code>CosinorM.KDE</code> lacks the
ability to directly provide standard errors or confidence intervals for
cosinor parameters and related post hoc estimates (e.g., bathyphase).
Thankfully, we can use bootstrap resampling to empirically estimate
confidence intervals and standard errors for these post‑hoc parameters.
Note that <code>CosinorM.KDE</code> is designed to stabilize estimates
when data are irregularly spaced or limited to short recording
intervals.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot.seci.html">boot.seci</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">fit.KDE</span>,</span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span> <span class="co">### for demonstration, the number of bootstraps was limited to 100.</span></span>
<span><span class="co">#&gt;                    Estimate Std Error t value    2.5%   97.5%</span></span>
<span><span class="co">#&gt; MESOR                177.24      4.60   38.55  168.93  185.37</span></span>
<span><span class="co">#&gt; Amplitude.24         157.66      7.15   22.08  145.51  171.65</span></span>
<span><span class="co">#&gt; Acrophase.24          -2.89      0.04  -73.22   -2.96   -2.82</span></span>
<span><span class="co">#&gt; Beta.24             -152.48      7.90  -19.39 -167.73 -138.96</span></span>
<span><span class="co">#&gt; Gamma.24             -39.60      5.28   -7.27  -48.30  -29.41</span></span>
<span><span class="co">#&gt; MESOR.ph             295.55     14.50   20.43  266.18  324.46</span></span>
<span><span class="co">#&gt; Bathyphase.ph.time     4.35      1.83    2.96    0.60    6.13</span></span>
<span><span class="co">#&gt; Trough.ph              8.12      1.84    4.93    5.09   11.66</span></span>
<span><span class="co">#&gt; Acrophase.ph.time     10.50      0.31   33.60    9.97   11.05</span></span>
<span><span class="co">#&gt; Peak.ph              582.97     29.10   20.04  522.64  638.85</span></span>
<span><span class="co">#&gt; Amplitude.ph         287.43     14.66   19.58  257.36  314.75</span></span></code></pre></div>
<p>Currently, was designed to compute standard errors and confidence
intervals in serial processes, which means that it will take some time
to finish the computation.</p>
<div class="section level4">
<h4 id="visualized-model-comparisons">Visualized Model Comparisons<a class="anchor" aria-label="anchor" href="#visualized-model-comparisons"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### For external graphic plot.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="ols-cosinor-vs--kernel-density-estimation">OLS-Cosinor vs. Kernel Density Estimation<a class="anchor" aria-label="anchor" href="#ols-cosinor-vs--kernel-density-estimation"></a>
</h5>
<p>When we compare the KDE-based estimate with the OLS-based cosinor
model, we can immediately see that <code>CosinorM.KDE</code> better
captures the complexity of the wearer’s activity pattern. Since
<code>CosinorM.KDE</code> does not assume a specific pattern of
activity, it avoids introducing bias from assumptions or model
specifications into the rest-activity-based circadian parameters.
<img src="Circadian-Analysis_files/figure-html/Model%201%20OLS%20vs%20KDE-1.png" class="r-plt" alt="Figure 7: Overlay of Fitting of OLS-based Cosinor and Circularized Gaussian Kernel Density Estimation" width="672"></p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by C. William Yao, Giorgio Varesco, François Bieuzen, Guido Simonelli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
